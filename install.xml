<?xml version="1.0" encoding="utf-8" standalone="yes"?>
<?xml-stylesheet type="text/xsl" href="modx.prosilver.en.xsl"?>
<!--For security purposes, please check: http://www.phpbb.com/mods/ for the latest version of this MOD. Although MODs are checked before being allowed in the MODs Database there is no guarantee that there are no security problems within the MOD. No support will be given for MODs not found within the MODs Database which can be found at http://www.phpbb.com/mods/-->
<mod xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xmlns="http://www.phpbb.com/mods/xml/modx-1.0.xsd">
	<header>
		<license>http://opensource.org/licenses/gpl-license.php GNU General Public License v2</license>
		<title lang="en-gb">Posting template</title>
		<description lang="en-gb">This MOD will allow you to set a "posting template" on per-forum basis. The posting template is a predefined "text", that will appear if a user starts a new topic in that forum.</description>
		<author-notes lang="en-gb">Thanks to ramon fincken (who made a phpBB2 version), for inspiring me to do this.</author-notes>
		<author-group>
			<author>
				<realname>Igor Wiedler</realname>
				<email>evil@phpbbmodders.net</email>
				<username>eviL&lt;3</username>
				<homepage>http://phpbbmodders.net</homepage>
				<contributions />
			</author>
		</author-group>
		<mod-version>
			<major>1</major>
			<minor>0</minor>
			<revision>0</revision>
			<release>a</release>
		</mod-version>
		<installation>
			<level>easy</level>
			<time>300</time>
			<target-version>
				<target-primary>3.0.0</target-primary>
				<target-major allow="exact">3</target-major>
				<target-minor allow="exact">0</target-minor>
			</target-version>
		</installation>
		<history>
			<entry>
				<date>2006-02-28</date>
				<rev-version>
					<major>0</major>
					<minor>1</minor>
					<revision>0</revision>
				</rev-version>
				<changelog lang="en-gb">
					<change>Initial release</change>
				</changelog>
			</entry>
			<entry>
				<date>2006-03-04</date>
				<rev-version>
					<major>0</major>
					<minor>1</minor>
					<revision>1</revision>
				</rev-version>
				<changelog lang="en-gb">
					<change>Updated target release</change>
				</changelog>
			</entry>
			<entry>
				<date>2008-01-01</date>
				<rev-version>
					<major>1</major>
					<minor>0</minor>
					<revision>0</revision>
				</rev-version>
				<changelog lang="en-gb">
					<change>Updated for gold.</change>
				</changelog>
			</entry>
		</history>
	</header>
	<action-group>
		<sql>ALTER TABLE phpbb_forums ADD forum_post_tpl TEXT DEFAULT '' NULL;</sql>
		<open src="posting.php">
			<edit>
				<find>$post_data['poll_options']		= array();</find>
				<action type="after-add"><![CDATA[
//-- mod : Posting Template ------------------------------------------------------------
//-- add
if ($mode == 'post' && !empty($post_data['forum_post_tpl']))
{
	$post_data['post_text'] = $post_data['forum_post_tpl'];
}
//-- fin mod : Posting Template --------------------------------------------------------
]]></action>
			</edit>
		</open>
		<open src="adm/style/acp_forums.html">
			<edit>
				<find><![CDATA[		<dt><label for="forum_desc">{L_FORUM_DESC}:</label><br /><span>{L_FORUM_DESC_EXPLAIN}</span></dt>]]></find>
				<find><![CDATA[	</dl>]]></find>
				<action type="after-add"><![CDATA[<!-- mod : Posting Template -->
	<dl>
		<dt><label for="forum_post_tpl">{L_FORUM_POST_TPL}:</label><br /><span>{L_FORUM_POST_TPL_EXPLAIN}</span></dt>
		<dd><textarea id="forum_post_tpl" name="forum_post_tpl" rows="5" cols="45" maxlength="255">{FORUM_POST_TPL}</textarea></dd>
	</dl>
<!-- fin mod : Posting Template -->]]></action>
			</edit>
		</open>
		<open src="includes/acp/acp_forums.php">
			<edit>
				<find><![CDATA[						'forum_desc_bitfield'	=> '',]]></find>
				<action type="after-add"><![CDATA[//-- mod : Posting Template ------------------------------------------------------------
//-- add
						'forum_post_tpl'		=> request_var('forum_post_tpl', '', true),
//-- fin mod : Posting Template --------------------------------------------------------]]></action>
			</edit>
			<edit>
				<find><![CDATA[							'forum_desc'			=> '',]]></find>
				<action type="after-add"><![CDATA[//-- mod : Posting Template ------------------------------------------------------------
//-- add
							'forum_post_tpl'		=> '',
//-- fin mod : Posting Template --------------------------------------------------------]]></action>
			</edit>
			<edit>
				<find><![CDATA[					'S_DESC_URLS_CHECKED'		=> ($forum_desc_data['allow_urls']) ? true : false,]]></find>
				<action type="after-add"><![CDATA[
//-- mod : Posting Template ------------------------------------------------------------
//-- add
					'FORUM_POST_TPL'			=> $forum_data['forum_post_tpl'],
//-- fin mod : Posting Template --------------------------------------------------------
]]></action>
			</edit>
		</open>
		<open src="language/en/acp/forums.php">
			<edit>
				<find><![CDATA[?>]]></find>
				<action type="before-add"><![CDATA[//-- mod : Posting Template ------------------------------------------------------------
//-- add
$lang = array_merge($lang, array(
	'FORUM_POST_TPL'					=> 'Posting template',
	'FORUM_POST_TPL_EXPLAIN'			=> 'The posting template is the text that appears in the textarea when starting a new topic in this forum. If you don\'t wish to use it, just leave it blank.',
));
//-- fin mod : Posting Template --------------------------------------------------------]]></action>
			</edit>
		</open>
	</action-group>
</mod>